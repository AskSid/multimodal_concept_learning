## SLURM PROLOG ###############################################################
##    Job ID : 13540347
##  Job Name : token_analysis
##  Nodelist : gpu1402
##      CPUs : 
##  Mem/Node : 16384 MB
## Directory : /oscar/data/epavlick/sboppana/multimodal_concept_learning
##   Job Started : Fri Oct 24 12:59:38 PM EDT 2025
###############################################################################
Loading embeddings from: /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/primary_secondary_5k
Saving plots to: /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/primary_secondary_5k/token_analysis
Loaded saved tokenizer with vocabulary size: 262148
Loaded initial model embeddings: torch.Size([262148, 1152])
Loaded epoch 0 embeddings: torch.Size([262148, 1152])
Loaded epoch 1 embeddings: torch.Size([262148, 1152])
Loaded epoch 2 embeddings: torch.Size([262148, 1152])
Loaded epoch 3 embeddings: torch.Size([262148, 1152])
Loaded epoch 4 embeddings: torch.Size([262148, 1152])
Loaded epoch 5 embeddings: torch.Size([262148, 1152])
Loaded epoch 6 embeddings: torch.Size([262148, 1152])
Loaded epoch 7 embeddings: torch.Size([262148, 1152])
Loaded epoch 8 embeddings: torch.Size([262148, 1152])
Loaded epoch 9 embeddings: torch.Size([262148, 1152])
Total loaded 11 embedding matrices
Found 3 OOD tokens and 3 regular tokens in labels mapping
OOD tokens: ['<ood 1>', '<ood 2>', '<ood 3>']
Tokenizer vocabulary size: 262148
Regular tokens: 3
OOD tokens: 3

=== Token Analysis ===
Total vocabulary size: 262148
Regular tokens: 3
OOD tokens: 3

Sample regular tokens: ['red', 'green', 'blue']

Sample OOD tokens: ['<ood 1>', '<ood 2>', '<ood 3>']

OOD token IDs: [262145, 262146, 262147]
Regular token IDs: [1192, 10671, 9503]...
Analyzing 6 tokens across 11 epochs
initial: (6, 1152)
epoch_0: (6, 1152)
epoch_1: (6, 1152)
epoch_2: (6, 1152)
epoch_3: (6, 1152)
epoch_4: (6, 1152)
epoch_5: (6, 1152)
epoch_6: (6, 1152)
epoch_7: (6, 1152)
epoch_8: (6, 1152)
epoch_9: (6, 1152)

Fitting UMAP on initial embeddings...
Transformed initial: (6, 2)
Transformed epoch_0: (6, 2)
Transformed epoch_1: (6, 2)
Transformed epoch_2: (6, 2)
Transformed epoch_3: (6, 2)
Transformed epoch_4: (6, 2)
Transformed epoch_5: (6, 2)
Transformed epoch_6: (6, 2)
Transformed epoch_7: (6, 2)
Transformed epoch_8: (6, 2)
Transformed epoch_9: (6, 2)
Extracted RGB colors for 6 tokens
Saved UMAP plot to /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/primary_secondary_5k/token_analysis/token_embeddings_umap.png

=== RGB Color Information ===
Regular tokens:
  red: RGB(1.000, 0.000, 0.000)
  green: RGB(0.000, 1.000, 0.000)
  blue: RGB(0.000, 0.000, 1.000)

OOD tokens (first 5):
  <ood 1>: RGB(1.000, 1.000, 0.000)
  <ood 2>: RGB(1.000, 0.000, 1.000)
  <ood 3>: RGB(0.000, 1.000, 1.000)
  ... and -2 more OOD tokens
=== Creating 3D UMAP Visualization ===
Using epoch_9 for 3D visualization
Token embeddings shape: (6, 1152)
Fitting 3D UMAP...
3D projections shape: (6, 3)
Saved 3D UMAP plot to /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/primary_secondary_5k/token_analysis/token_embeddings_3d_umap.html
3D UMAP visualization complete!
=== Regular Tokens UMAP Analysis ===
initial: (3, 1152)
epoch_0: (3, 1152)
epoch_1: (3, 1152)
epoch_2: (3, 1152)
epoch_3: (3, 1152)
epoch_4: (3, 1152)
epoch_5: (3, 1152)
epoch_6: (3, 1152)
epoch_7: (3, 1152)
epoch_8: (3, 1152)
epoch_9: (3, 1152)

Fitting UMAP on regular tokens from initial epoch...
Token embedding analysis completed at Fri Oct 24 01:01:59 PM EDT 2025
