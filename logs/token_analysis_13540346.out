## SLURM PROLOG ###############################################################
##    Job ID : 13540346
##  Job Name : token_analysis
##  Nodelist : gpu2002
##      CPUs : 
##  Mem/Node : 16384 MB
## Directory : /oscar/data/epavlick/sboppana/multimodal_concept_learning
##   Job Started : Fri Oct 24 12:57:57 PM EDT 2025
###############################################################################
Loading embeddings from: /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/96_colors_375
Saving plots to: /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/96_colors_375/token_analysis
Loaded saved tokenizer with vocabulary size: 262235
Loaded initial model embeddings: torch.Size([262235, 1152])
Loaded epoch 0 embeddings: torch.Size([262235, 1152])
Loaded epoch 1 embeddings: torch.Size([262235, 1152])
Loaded epoch 2 embeddings: torch.Size([262235, 1152])
Loaded epoch 3 embeddings: torch.Size([262235, 1152])
Loaded epoch 4 embeddings: torch.Size([262235, 1152])
Loaded epoch 5 embeddings: torch.Size([262235, 1152])
Loaded epoch 6 embeddings: torch.Size([262235, 1152])
Loaded epoch 7 embeddings: torch.Size([262235, 1152])
Loaded epoch 8 embeddings: torch.Size([262235, 1152])
Loaded epoch 9 embeddings: torch.Size([262235, 1152])
Total loaded 11 embedding matrices
Found 90 OOD tokens and 6 regular tokens in labels mapping
OOD tokens: ['<ood 1>', '<ood 2>', '<ood 3>', '<ood 4>', '<ood 5>', '<ood 6>', '<ood 7>', '<ood 8>', '<ood 9>', '<ood 10>', '<ood 11>', '<ood 12>', '<ood 13>', '<ood 14>', '<ood 15>', '<ood 16>', '<ood 17>', '<ood 18>', '<ood 19>', '<ood 20>', '<ood 21>', '<ood 22>', '<ood 23>', '<ood 24>', '<ood 25>', '<ood 26>', '<ood 27>', '<ood 28>', '<ood 29>', '<ood 30>', '<ood 31>', '<ood 32>', '<ood 33>', '<ood 34>', '<ood 35>', '<ood 36>', '<ood 37>', '<ood 38>', '<ood 39>', '<ood 40>', '<ood 41>', '<ood 42>', '<ood 43>', '<ood 44>', '<ood 45>', '<ood 46>', '<ood 47>', '<ood 48>', '<ood 49>', '<ood 50>', '<ood 51>', '<ood 52>', '<ood 53>', '<ood 54>', '<ood 55>', '<ood 56>', '<ood 57>', '<ood 58>', '<ood 59>', '<ood 60>', '<ood 61>', '<ood 62>', '<ood 63>', '<ood 64>', '<ood 65>', '<ood 66>', '<ood 67>', '<ood 68>', '<ood 69>', '<ood 70>', '<ood 71>', '<ood 72>', '<ood 73>', '<ood 74>', '<ood 75>', '<ood 76>', '<ood 77>', '<ood 78>', '<ood 79>', '<ood 80>', '<ood 81>', '<ood 82>', '<ood 83>', '<ood 84>', '<ood 85>', '<ood 86>', '<ood 87>', '<ood 88>', '<ood 89>', '<ood 90>']
Tokenizer vocabulary size: 262235
Regular tokens: 6
OOD tokens: 90

=== Token Analysis ===
Total vocabulary size: 262235
Regular tokens: 6
OOD tokens: 90

Sample regular tokens: ['red', 'green', 'blue', 'yellow', 'magenta']

Sample OOD tokens: ['<ood 1>', '<ood 2>', '<ood 3>', '<ood 4>', '<ood 5>']

OOD token IDs: [262145, 262146, 262147, 262148, 262149, 262150, 262151, 262152, 262153, 262154, 262155, 262156, 262157, 262158, 262159, 262160, 262161, 262162, 262163, 262164, 262165, 262166, 262167, 262168, 262169, 262170, 262171, 262172, 262173, 262174, 262175, 262176, 262177, 262178, 262179, 262180, 262181, 262182, 262183, 262184, 262185, 262186, 262187, 262188, 262189, 262190, 262191, 262192, 262193, 262194, 262195, 262196, 262197, 262198, 262199, 262200, 262201, 262202, 262203, 262204, 262205, 262206, 262207, 262208, 262209, 262210, 262211, 262212, 262213, 262214, 262215, 262216, 262217, 262218, 262219, 262220, 262221, 262222, 262223, 262224, 262225, 262226, 262227, 262228, 262229, 262230, 262231, 262232, 262233, 262234]
Regular token IDs: [1192, 10671, 9503, 23861, 96984, 57182]...
Analyzing 96 tokens across 11 epochs
initial: (96, 1152)
epoch_0: (96, 1152)
epoch_1: (96, 1152)
epoch_2: (96, 1152)
epoch_3: (96, 1152)
epoch_4: (96, 1152)
epoch_5: (96, 1152)
epoch_6: (96, 1152)
epoch_7: (96, 1152)
epoch_8: (96, 1152)
epoch_9: (96, 1152)

Fitting UMAP on initial embeddings...
Transformed initial: (96, 2)
Transformed epoch_0: (96, 2)
Transformed epoch_1: (96, 2)
Transformed epoch_2: (96, 2)
Transformed epoch_3: (96, 2)
Transformed epoch_4: (96, 2)
Transformed epoch_5: (96, 2)
Transformed epoch_6: (96, 2)
Transformed epoch_7: (96, 2)
Transformed epoch_8: (96, 2)
Transformed epoch_9: (96, 2)
Extracted RGB colors for 96 tokens
Saved UMAP plot to /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/96_colors_375/token_analysis/token_embeddings_umap.png

=== RGB Color Information ===
Regular tokens:
  red: RGB(1.000, 0.000, 0.000)
  green: RGB(0.000, 1.000, 0.000)
  blue: RGB(0.000, 0.000, 1.000)
  yellow: RGB(1.000, 1.000, 0.000)
  magenta: RGB(1.000, 0.000, 1.000)
  cyan: RGB(0.000, 1.000, 1.000)

OOD tokens (first 5):
  <ood 1>: RGB(1.000, 0.125, 0.000)
  <ood 2>: RGB(1.000, 0.000, 0.125)
  <ood 3>: RGB(0.125, 1.000, 0.000)
  <ood 4>: RGB(0.000, 1.000, 0.125)
  <ood 5>: RGB(0.125, 0.000, 1.000)
  ... and 85 more OOD tokens
=== Creating 3D UMAP Visualization ===
Using epoch_9 for 3D visualization
Token embeddings shape: (96, 1152)
Fitting 3D UMAP...
3D projections shape: (96, 3)
Saved 3D UMAP plot to /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/96_colors_375/token_analysis/token_embeddings_3d_umap.html
3D UMAP visualization complete!
=== Regular Tokens UMAP Analysis ===
initial: (6, 1152)
epoch_0: (6, 1152)
epoch_1: (6, 1152)
epoch_2: (6, 1152)
epoch_3: (6, 1152)
epoch_4: (6, 1152)
epoch_5: (6, 1152)
epoch_6: (6, 1152)
epoch_7: (6, 1152)
epoch_8: (6, 1152)
epoch_9: (6, 1152)

Fitting UMAP on regular tokens from initial epoch...
Transformed initial: (6, 2)
Transformed epoch_0: (6, 2)
Transformed epoch_1: (6, 2)
Transformed epoch_2: (6, 2)
Transformed epoch_3: (6, 2)
Transformed epoch_4: (6, 2)
Transformed epoch_5: (6, 2)
Transformed epoch_6: (6, 2)
Transformed epoch_7: (6, 2)
Transformed epoch_8: (6, 2)
Transformed epoch_9: (6, 2)
Saved regular tokens UMAP plot to /users/sboppana/data/sboppana/multimodal_concept_learning/results/multimodal/color/96_colors_375/token_analysis/regular_tokens_umap.png

=== Regular Token Distance Analysis ===

initial:
  red ↔ green: 1.040
  red ↔ blue: 1.030
  red ↔ yellow: 1.008
  red ↔ magenta: 2.039
  red ↔ cyan: 2.044
  green ↔ blue: 0.983
  green ↔ yellow: 0.865
  green ↔ magenta: 1.022
  green ↔ cyan: 1.277
  blue ↔ yellow: 1.635
  blue ↔ magenta: 1.553
  blue ↔ cyan: 1.197
  yellow ↔ magenta: 1.740
  yellow ↔ cyan: 2.138
  magenta ↔ cyan: 0.806

epoch_0:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_1:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_2:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_3:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_4:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_5:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_6:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_7:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_8:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

epoch_9:
  red ↔ green: 3.194
  red ↔ blue: 3.226
  red ↔ yellow: 0.074
  red ↔ magenta: 3.187
  red ↔ cyan: 3.176
  green ↔ blue: 0.039
  green ↔ yellow: 3.234
  green ↔ magenta: 0.011
  green ↔ cyan: 0.023
  blue ↔ yellow: 3.266
  blue ↔ magenta: 0.050
  blue ↔ cyan: 0.062
  yellow ↔ magenta: 3.228
  yellow ↔ cyan: 3.216
  magenta ↔ cyan: 0.013

=== Color-Embedding Distance Correlation Analysis (initial) ===
Calculating pairwise distances for 6 regular tokens...
Number of token pairs: 15
Color distance range: [1.0000, 3.0000]
Embedding distance range: [0.5291, 0.8493]
Pearson correlation coefficient: 0.0618

=== FINAL CORRELATION RESULT ===
Color-Embedding Distance Correlation: 0.0618

Analysis complete!
Token embedding analysis completed at Fri Oct 24 12:59:50 PM EDT 2025
